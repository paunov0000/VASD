@model IEnumerable<UserTableModel>

@{
    ViewBag.Title = "Index";
}

<div class="flex flex-col gap-5">
    <div class="flex gap-7">
        <div>
            <label for="count">Show</label>
            <select id="count">
                <option value="0">All</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="5">5</option>
                <option value="10">10</option>
            </select>
            <span>entries</span>
        </div>
        <div>
            <label for="sort">Sort by</label>
            <select id="sort">
                <option value="userName-asc">Username Ascending</option>
                <option value="userName-desc">Username Descending</option>
                <option value="email-asc">Email Ascending</option>
                <option value="email-desc">Email Descending</option>
                <option value="phoneNumber-t">With Phone Number</option>
                <option value="phoneNumber-f">Without Phone Number</option>
            </select>
        </div>
    </div>
    <a id="search" class="cursor-pointer">Submit</a>
    @*  <div class="flex gap-3  ">
    <div>
    <a asp-area="Admin" asp-controller="Product" asp-action="Add" class="text-white bg-green-500 hover:bg-green-700 font-medium rounded-lg text-sm px-5 py-2.5 text-center">
    Add Product
    </a>
    </div>

    <div>
    <a asp-area="Admin" asp-controller="Product" asp-action="Restock" class="text-white bg-amber-500 hover:bg-amber-700 font-medium rounded-lg text-sm px-5 py-2.5 text-center">
    Restock
    </a>
    </div>
    </div> *@
    <div class="border border-gray-300 rounded-lg overflow-hidden">
        <table class="w-full">
            <tr class="bg-gray-200 text-left">
                <th class="pl-7 py-2">
                    @Html.DisplayNameFor(model => model.UserName)
                </th>
                <th class="py-2">
                    @Html.DisplayNameFor(model => model.Email)
                </th>
                <th class="py-2">
                    @Html.DisplayNameFor(model => model.Roles)
                </th>
                <th class="pr-1 py-2">
                    @Html.DisplayNameFor(model => model.PhoneNumber)
                </th>

            </tr>
            @foreach (var product in Model)
            {
                <tr class="text-left font-medium">
                    <td class="pl-7 py-2">
                        <a class="hover:text-blue-500" asp-area="Admin" asp-controller="User" asp-action="Details" asp-route-id="@product.Id">
                            @product.UserName
                        </a>
                    </td>
                    <td class="py-2">
                        @product.Email
                    </td>
                    <td class="py-2">

                        @Html.Raw(string.Join(" | ", product.Roles.Select(r =>
                                 {
                                     var color = r switch
                                     {
                                         "Administrator" => "text-red-500",
                                         "Vip" => "text-yellow-500",
                                         "Customer" => "text-fuchsia-500",
                                         _ => "text-gray-500"
                                     };
                                     return $"<span class='{color} font-semibold'>{r}</span>";
                                 })))

                    </td>
                    <td class="pr-1 py-2">
                        @if (product.PhoneNumber == null)
                        {
                            <span class="text-red-400 italic">[Not Available]</span>
                        }
                        else
                        {
                            <span>@product.PhoneNumber</span>
                        }
                    </td>
                </tr>
            }
        </table>
    </div>
</div>

@section Scripts {
    <script>
        document.getElementById("search").onclick = function () {
            var count = document.getElementById("count").value;
            var sort = document.getElementById("sort").value;
            var url = new URL(window.location.href);
            url.searchParams.set("count", count);
            url.searchParams.set("sort", sort);
            window.location.href = url;
        };
    </script>
}
